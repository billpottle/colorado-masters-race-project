<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Colorado Masters Race Project</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <header>
      <h1 class="title">Colorado Masters Race Project</h1>
      <p class="subtitle">Aggregated results for Colorado Masters track races</p>
    </header>

    <main>
      <section class="card" aria-labelledby="overview-title">
        <div class="card-content">
          <div class="card-header">
            <h2 id="overview-title" class="section-title" style="margin: 0;"><span class="dot"></span>Overview</h2>
            <div class="perf-inline" aria-label="Performances summary">
              <span class="label">Performances</span>
              <span class="sep">·</span>
              <span class="all">
                <span class="value" id="perf-total">—</span>
                <span class="label">ALL</span>
              </span>
              <span class="sep">·</span>
              <span class="male">
                <span class="value" id="perf-male">—</span>
                <span class="label">M</span>
              </span>
              <span class="sep">·</span>
              <span class="female">
                <span class="value" id="perf-female">—</span>
                <span class="label">F</span>
              </span>
              <span id="perf-breakdown" class="hidden"></span>
            </div>
          </div>
          <div class="stats-grid" role="list">
            <div class="stat" role="listitem">
              <div class="stat-label"><span class="pill">Races</span></div>
              <div class="stat-value" id="race-total">—</div>
            </div>

            <div class="stat" role="listitem">
              <div class="stat-label"><span class="pill">Earliest Race</span></div>
              <div class="stat-value nowrap" id="race-earliest">—</div>
            </div>

            <div class="stat" role="listitem">
              <div class="stat-label"><span class="pill">Most Recent</span></div>
              <div class="stat-value nowrap" id="race-latest">—</div>
            </div>
          </div>
          <div class="loading" id="loading">Loading data…</div>
          <div class="error hidden" id="error">Failed to load data. Please try again later.</div>
          <div class="footer-note">One performance equals one row in <code>all-data.csv</code>. A race is defined as a unique combination of Date and Meet name.</div>

          <div id="local-picker" class="hidden" style="margin-top:16px;">
            <label style="display:block; margin-bottom:8px; color: var(--muted); font-size: 13px;">Open locally without a server: select <code>all-data.csv</code></label>
            <input id="csv-file-input" type="file" accept=".csv,text/csv" />
            <div class="footer-note">This fallback is only needed when opening the page via <code>file://</code>. On GitHub Pages or a local server, the CSV loads automatically.</div>
          </div>
        </div>
      </section>

      <section class="card" aria-labelledby="notice-title" style="margin-top: 20px;">
        <div class="card-content">
          <h2 id="notice-title" class="section-title"><span class="dot"></span>Notice</h2>
          <p class="subtitle" style="max-width: 80ch;">
            This is an unofficial, preliminary list and will be updated over time as more data is added.
          </p>
        </div>
      </section>

      <section class="card" aria-labelledby="search-title" style="margin-top: 20px;">
        <div class="card-content">
          <h2 id="search-title" class="section-title"><span class="dot"></span>Check your results</h2>
          <div class="search-row">
            <input id="search-input" class="input" type="text" placeholder="Enter name (e.g., Jane Doe)" />
            <button id="search-btn" class="button" type="button">Search</button>
            <div id="search-hint" class="footer-note">Full or partial match, case-insensitive.</div>
          </div>
          <div id="results-summary" class="subtitle" style="margin-top: 10px;"></div>
          <div id="results-table" class="table-container"></div>
        </div>
      </section>
    </main>

    <!-- Papa Parse for robust CSV parsing -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script defer src="app.js"></script>
  </body>
</html>
